<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="description" content="FastReader - A free, open-source RSVP speed reading app. Read faster with Rapid Serial Visual Presentation.">
    <meta name="theme-color" content="#1a1a2e">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="FastReader">
    
    <title>FastReader - RSVP Speed Reading</title>
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="manifest.json">
    
    <!-- Icons -->
    <link rel="icon" href="icons/favicon.svg" type="image/svg+xml">
    <link rel="apple-touch-icon" href="icons/icon-192.png">
    
    <!-- Fonts -->
    <link rel="preload" href="fonts/OpenDyslexic-Regular.otf" as="font" type="font/otf" crossorigin>
    
    <!-- Styles -->
    <link rel="stylesheet" href="styles.css">
</head>
<body data-theme="dark">
    <!-- Offline Banner -->
    <div id="offlineBanner" class="offline-banner hidden">
        <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M1 1l22 22M16.72 11.06A10.94 10.94 0 0119 12.55M5 12.55a10.94 10.94 0 015.17-2.39M10.71 5.05A16 16 0 0122.58 9M1.42 9a15.91 15.91 0 014.7-2.88M8.53 16.11a6 6 0 016.95 0M12 20h.01"/>
        </svg>
        <span>You're offline â€” reading from cache</span>
    </div>

    <!-- Main Canvas -->
    <canvas id="stage"></canvas>

    <!-- Progress Display -->
    <div id="progressDisplay" class="progress-display">
        <span id="progressText">Word 0 of 0</span>
        <div id="progressBar" class="progress-bar">
            <div id="progressFill" class="progress-fill"></div>
        </div>
    </div>

    <!-- Controls -->
    <div id="controls" class="controls">
        <!-- Primary Controls -->
        <div class="controls-row primary-controls">
            <button id="resetBtn" class="btn btn-icon" title="Reset (R)">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"/>
                    <path d="M3 3v5h5"/>
                </svg>
            </button>
            
            <button id="backBtn" class="btn btn-icon" title="Back (â†)">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M19 12H5M12 19l-7-7 7-7"/>
                </svg>
            </button>
            
            <button id="playBtn" class="btn btn-primary" title="Play/Pause (Space)">
                <svg id="playIcon" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M8 5v14l11-7z"/>
                </svg>
                <svg id="pauseIcon" class="hidden" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M6 4h4v16H6zM14 4h4v16h-4z"/>
                </svg>
            </button>
            
            <button id="fwdBtn" class="btn btn-icon" title="Forward (â†’)">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M5 12h14M12 5l7 7-7 7"/>
                </svg>
            </button>
            
            <button id="textBtn" class="btn btn-icon" title="Set Text">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
                    <path d="M14 2v6h6M16 13H8M16 17H8M10 9H8"/>
                </svg>
            </button>
        </div>

        <!-- Settings Toggle (Mobile) -->
        <button id="settingsToggle" class="btn btn-icon settings-toggle" title="Settings">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="12" cy="12" r="3"/>
                <path d="M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"/>
            </svg>
        </button>

        <!-- Secondary Controls (Collapsible on mobile) -->
        <div id="settingsPanel" class="controls-row secondary-controls">
            <!-- WPM Control -->
            <div class="control-group wpm-control">
                <label id="wpmLabel" class="wpm-label" title="Click to edit">
                    WPM: <span id="wpmValue">300</span>
                </label>
                <input type="number" id="wpmInput" class="wpm-input hidden" min="50" max="1500" value="300">
                <input type="range" id="wpmRange" class="wpm-range" min="50" max="1500" value="300">
            </div>

            <!-- Profile Selector -->
            <div class="control-group">
                <select id="profileSelect" class="select" title="Pause Profile">
                    <option value="relaxed">Relaxed</option>
                    <option value="normal" selected>Normal</option>
                    <option value="speed">Speed</option>
                </select>
            </div>

            <!-- Font Selector -->
            <div class="control-group">
                <select id="fontSelect" class="select" title="Font">
                    <option value="system">System Default</option>
                    <option value="Arial">Arial</option>
                    <option value="Verdana">Verdana</option>
                    <option value="Georgia">Georgia</option>
                    <option value="Times New Roman">Times New Roman</option>
                    <option value="Trebuchet MS">Trebuchet MS</option>
                    <option value="Tahoma">Tahoma</option>
                    <option value="Courier New">Courier New</option>
                    <option value="OpenDyslexic">OpenDyslexic</option>
                </select>
            </div>

            <!-- Highlight Mode Selector -->
            <div class="control-group">
                <select id="highlightSelect" class="select" title="Highlight Mode">
                    <option value="classic">â—‰ Classic</option>
                    <option value="startEnd">âŸ¨âŸ© Start-End</option>
                    <option value="adaptive">â†” Adaptive</option>
                    <option value="syllable">âˆ¿ Syllable</option>
                    <option value="morpheme">â§ˆ Morpheme</option>
                    <option value="minimal">â—‹ Minimal</option>
                </select>
            </div>

            <!-- Toggle Buttons -->
            <button id="loopToggleBtn" class="btn btn-toggle" title="Loop">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M17 1l4 4-4 4"/>
                    <path d="M3 11V9a4 4 0 0 1 4-4h14"/>
                    <path d="M7 23l-4-4 4-4"/>
                    <path d="M21 13v2a4 4 0 0 1-4 4H3"/>
                </svg>
                <span class="toggle-label">Loop</span>
            </button>

            <button id="themeBtn" class="btn btn-toggle" title="Toggle Theme (T)">
                <svg id="sunIcon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="5"/>
                    <path d="M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"/>
                </svg>
                <svg id="moonIcon" class="hidden" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
                </svg>
            </button>

            <button id="researchBtn" class="btn btn-toggle" title="Research & Science">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"/>
                    <path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"/>
                </svg>
                <span class="toggle-label">Research</span>
            </button>
        </div>
    </div>

    <!-- Text Input Modal -->
    <div id="modalBackdrop" class="modal-backdrop hidden">
        <div class="modal">
            <div class="modal-header">
                <h2>Set Reading Text</h2>
                <button id="closeModalBtn" class="btn btn-icon modal-close">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M18 6L6 18M6 6l12 12"/>
                    </svg>
                </button>
            </div>
            
            <div class="modal-body">
                <textarea id="textArea" class="text-area" placeholder="Paste your text here..."></textarea>
                
                <div class="file-upload">
                    <label for="fileInput" class="file-label">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                            <polyline points="17 8 12 3 7 8"/>
                            <line x1="12" y1="3" x2="12" y2="15"/>
                        </svg>
                        <span>Upload file (.txt, .pdf)</span>
                    </label>
                    <input type="file" id="fileInput" accept=".txt,.pdf,text/plain,application/pdf" class="file-input">
                </div>

                <!-- Recent PDFs -->
                <div id="recentPdfs" class="recent-pdfs hidden">
                    <h3>Recent Documents</h3>
                    <ul id="recentList" class="recent-list"></ul>
                </div>

                <!-- PDF Loading Status -->
                <div id="pdfStatus" class="pdf-status hidden">
                    <div class="pdf-status-icon">
                        <svg class="spinner" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M12 2v4M12 18v4M4.93 4.93l2.83 2.83M16.24 16.24l2.83 2.83M2 12h4M18 12h4M4.93 19.07l2.83-2.83M16.24 7.76l2.83-2.83"/>
                        </svg>
                    </div>
                    <span id="pdfStatusText">Loading PDF...</span>
                </div>
            </div>
            
            <div class="modal-footer">
                <button id="cancelModalBtn" class="btn btn-secondary">Cancel</button>
                <button id="applyModalBtn" class="btn btn-primary">Apply</button>
            </div>
        </div>
    </div>

    <!-- PDF Loading Options Modal -->
    <div id="pdfOptionsBackdrop" class="modal-backdrop hidden">
        <div class="modal modal-small">
            <div class="modal-header">
                <h2>PDF Loading Options</h2>
                <button id="closePdfOptionsBtn" class="btn btn-icon modal-close">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M18 6L6 18M6 6l12 12"/>
                    </svg>
                </button>
            </div>
            
            <div class="modal-body">
                <p id="pdfInfoText" class="pdf-info-text">This PDF has X pages (~Y words)</p>
                
                <div class="pdf-options">
                    <button id="loadAllPagesBtn" class="btn btn-option">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
                            <path d="M14 2v6h6"/>
                            <path d="M12 18v-6M9 15l3 3 3-3"/>
                        </svg>
                        <div class="option-text">
                            <strong>Load All Pages</strong>
                            <span>Wait for complete document before reading</span>
                        </div>
                    </button>
                    
                    <button id="loadQuickStartBtn" class="btn btn-option">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/>
                        </svg>
                        <div class="option-text">
                            <strong>Quick Start</strong>
                            <span>Load first 3 pages, continue loading in background</span>
                        </div>
                    </button>
                </div>

                <!-- Loading Progress -->
                <div id="pdfLoadingProgress" class="pdf-loading-progress hidden">
                    <div class="pdf-status-icon">
                        <svg class="spinner" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M12 2v4M12 18v4M4.93 4.93l2.83 2.83M16.24 16.24l2.83 2.83M2 12h4M18 12h4M4.93 19.07l2.83-2.83M16.24 7.76l2.83-2.83"/>
                        </svg>
                    </div>
                    <span id="pdfLoadingText">Loading pages...</span>
                    <div class="progress-bar">
                        <div id="pdfProgressFill" class="progress-fill"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Loading Overlay (for PDF page loading during reading) -->
    <div id="loadingOverlay" class="loading-overlay hidden">
        <div class="loading-content">
            <svg class="spinner large" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M12 2v4M12 18v4M4.93 4.93l2.83 2.83M16.24 16.24l2.83 2.83M2 12h4M18 12h4M4.93 19.07l2.83-2.83M16.24 7.76l2.83-2.83"/>
            </svg>
            <span>Loading next page...</span>
        </div>
    </div>

    <!-- Research Modal -->
    <div id="researchBackdrop" class="modal-backdrop hidden">
        <div class="modal modal-research">
            <div class="modal-header">
                <h2>ðŸ“š The Science Behind FastReader</h2>
                <button id="closeResearchBtn" class="btn btn-icon modal-close">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M18 6L6 18M6 6l12 12"/>
                    </svg>
                </button>
            </div>
            
            <div class="modal-body research-body">
                <p class="research-intro">Each highlight mode in FastReader is grounded in peer-reviewed reading science research. Click any mode below to explore the academic foundations.</p>
                
                <!-- Quick Navigation Tabs -->
                <div class="research-nav">
                    <button class="research-nav-btn" data-target="research-classic" title="Classic ORP">â—‰</button>
                    <button class="research-nav-btn" data-target="research-startend" title="Start-End Anchoring">âŸ¨âŸ©</button>
                    <button class="research-nav-btn" data-target="research-adaptive" title="Adaptive Focus">â†”</button>
                    <button class="research-nav-btn" data-target="research-syllable" title="Syllable Rhythm">âˆ¿</button>
                    <button class="research-nav-btn" data-target="research-morpheme" title="Morpheme Structure">â§ˆ</button>
                    <button class="research-nav-btn" data-target="research-minimal" title="Minimal">â—‹</button>
                </div>
                
                <!-- Classic ORP -->
                <details id="research-classic" class="research-section" open>
                    <summary class="research-header">
                        <span class="research-icon">â—‰</span>
                        <span>Classic (Optimal Recognition Point)</span>
                    </summary>
                    <div class="research-content">
                        <p>The ORP (Optimal Recognition Point) is typically located slightly left of center in a wordâ€”approximately 35-40% from the start. This position minimizes the total distance the eye must travel to recognize all letters.</p>
                        
                        <h4>Key Research</h4>
                        <ul class="citation-list">
                            <li>
                                <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4617552/" target="_blank" rel="noopener">Potter, M.C., Wyble, B., Hagmann, C.E., & McCourt, E.S. (2014). Detecting meaning in RSVP at 13 ms per picture. <em>Attention, Perception, & Psychophysics, 76</em>(2), 270-279.</a>
                                <span class="citation-note">Foundational study showing RSVP enables rapid comprehension at extremely high speeds.</span>
                            </li>
                            <li>
                                <a href="https://www.sciencedirect.com/science/article/pii/S0042698909005252" target="_blank" rel="noopener">Rayner, K. (2009). Eye movements and attention in reading, scene perception, and visual search. <em>Quarterly Journal of Experimental Psychology, 62</em>(8), 1457-1506.</a>
                                <span class="citation-note">Comprehensive review showing eyes naturally fixate at optimal positions for word recognition.</span>
                            </li>
                            <li>
                                <a href="https://link.springer.com/article/10.3758/BF03200810" target="_blank" rel="noopener">O'Regan, J.K., & Jacobs, A.M. (1992). Optimal viewing position effect in word recognition. <em>Journal of Experimental Psychology: Human Perception and Performance, 18</em>(1), 185-197.</a>
                                <span class="citation-note">Seminal paper establishing the optimal viewing position (OVP) concept in reading.</span>
                            </li>
                        </ul>
                    </div>
                </details>

                <!-- Start-End Anchoring -->
                <details id="research-startend" class="research-section">
                    <summary class="research-header">
                        <span class="research-icon">âŸ¨âŸ©</span>
                        <span>Start-End Anchoring</span>
                    </summary>
                    <div class="research-content">
                        <p>Research shows readers rely heavily on the first and last letters of words for recognition. The brain processes these "anchor" positions preferentially, enabling accurate word identification even when middle letters are scrambled.</p>
                        
                        <h4>Key Research</h4>
                        <ul class="citation-list">
                            <li>
                                <a href="https://link.springer.com/article/10.3758/s13423-012-0247-y" target="_blank" rel="noopener">Johnson, R.L., & Eisler, M.E. (2012). The importance of the first and last letter in words during sentence reading. <em>Psychonomic Bulletin & Review, 19</em>(6), 1081-1088.</a>
                                <span class="citation-note">Shows transposing exterior letters severely disrupts reading, confirming their critical role.</span>
                            </li>
                            <li>
                                <a href="https://www.sciencedirect.com/science/article/pii/S0010027704001775" target="_blank" rel="noopener">Grainger, J., & Whitney, C. (2004). Does the huamn mnid raed wrods as a wlohe? <em>Trends in Cognitive Sciences, 8</em>(2), 58-59.</a>
                                <span class="citation-note">Famous study on letter position effects showing first/last letters are critical anchors.</span>
                            </li>
                            <li>
                                <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3166198/" target="_blank" rel="noopener">White, S.J., Johnson, R.L., Liversedge, S.P., & Rayner, K. (2008). Eye movements when reading transposed text. <em>Journal of Experimental Psychology: Human Perception and Performance, 34</em>(5), 1277-1284.</a>
                                <span class="citation-note">Eye-tracking evidence that edge letters have unique cognitive weight in word identification.</span>
                            </li>
                        </ul>
                        <div class="research-insight">
                            <strong>ðŸ’¡ Dyslexia Note:</strong> This mode may benefit readers with dyslexia, as it reinforces word boundaries which research shows can be helpful for those who experience visual crowding effects.
                        </div>
                    </div>
                </details>

                <!-- Adaptive Focus -->
                <details id="research-adaptive" class="research-section">
                    <summary class="research-header">
                        <span class="research-icon">â†”</span>
                        <span>Adaptive Focus</span>
                    </summary>
                    <div class="research-content">
                        <p>Adaptive highlighting combines ORP research with findings on word length effects. Shorter words are processed holistically while longer words benefit from strategic fixation placement.</p>
                        
                        <h4>Key Research</h4>
                        <ul class="citation-list">
                            <li>
                                <a href="https://www.sciencedirect.com/science/article/pii/S0042698998002423" target="_blank" rel="noopener">Nazir, T.A., Jacobs, A.M., & O'Regan, J.K. (1998). Letter legibility and visual word recognition. <em>Memory & Cognition, 26</em>(4), 810-821.</a>
                                <span class="citation-note">Shows optimal viewing position shifts based on word length and structure.</span>
                            </li>
                            <li>
                                <a href="https://link.springer.com/article/10.3758/s13423-014-0634-1" target="_blank" rel="noopener">Schotter, E.R., Angele, B., & Rayner, K. (2012). Parafoveal processing in reading. <em>Attention, Perception, & Psychophysics, 74</em>(1), 5-35.</a>
                                <span class="citation-note">Evidence that skilled readers dynamically allocate attention based on word properties.</span>
                            </li>
                            <li>
                                <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3117157/" target="_blank" rel="noopener">Vitu, F., O'Regan, J.K., & Mittau, M. (1990). Optimal landing position in reading isolated words and continuous text. <em>Perception & Psychophysics, 47</em>(6), 583-600.</a>
                                <span class="citation-note">Classic study showing landing position varies with word characteristics.</span>
                            </li>
                        </ul>
                    </div>
                </details>

                <!-- Syllable Rhythm -->
                <details id="research-syllable" class="research-section">
                    <summary class="research-header">
                        <span class="research-icon">âˆ¿</span>
                        <span>Syllable Rhythm</span>
                    </summary>
                    <div class="research-content">
                        <p>Syllable-based segmentation leverages the phonological structure of language. Research shows that visual syllable boundaries can enhance reading fluency, particularly for complex or unfamiliar words.</p>
                        
                        <h4>Key Research</h4>
                        <ul class="citation-list">
                            <li>
                                <a href="https://www.sciencedirect.com/science/article/pii/S0028393218300318" target="_blank" rel="noopener">Chetail, F. (2015). Reconsidering the role of orthographic redundancy in visual word recognition. <em>Frontiers in Psychology, 6</em>, 645.</a>
                                <span class="citation-note">Shows syllable-based visual chunking aids reading in multiple languages.</span>
                            </li>
                            <li>
                                <a href="https://www.tandfonline.com/doi/abs/10.1080/02643294.2019.1659936" target="_blank" rel="noopener">Doignon-Camus, N., & Zagar, D. (2014). The syllable frequency effect in visual word recognition. <em>Journal of Cognitive Psychology, 26</em>(1), 1-16.</a>
                                <span class="citation-note">Demonstrates syllables serve as natural processing units in reading.</span>
                            </li>
                            <li>
                                <a href="https://link.springer.com/article/10.1007/s11145-014-9534-0" target="_blank" rel="noopener">Bhattacharya, A., & Ehri, L.C. (2004). Graphosyllabic analysis helps adolescent struggling readers read and spell words. <em>Journal of Learning Disabilities, 37</em>(4), 331-348.</a>
                                <span class="citation-note">Color-coded syllables aid vocabulary acquisition and pronunciation in struggling readers.</span>
                            </li>
                        </ul>
                        <div class="research-insight">
                            <strong>ðŸ’¡ Language Learning:</strong> Syllable highlighting is particularly effective for L2 (second language) learners as it makes phonological structure explicit.
                        </div>
                    </div>
                </details>

                <!-- Morpheme Structure -->
                <details id="research-morpheme" class="research-section">
                    <summary class="research-header">
                        <span class="research-icon">â§ˆ</span>
                        <span>Morpheme Structure</span>
                    </summary>
                    <div class="research-content">
                        <p>Morphological awarenessâ€”understanding how prefixes, roots, and suffixes create meaningâ€”is one of the strongest predictors of reading comprehension and vocabulary growth. Visual morpheme highlighting makes this structure explicit.</p>
                        
                        <h4>Key Research</h4>
                        <ul class="citation-list">
                            <li>
                                <a href="https://psycnet.apa.org/record/2018-62611-001" target="_blank" rel="noopener">Levesque, K.C., Kieffer, M.J., & Deacon, S.H. (2019). Inferring meaning from meaningful parts: The contributions of morphological skills to the development of children's reading comprehension. <em>Reading Research Quarterly, 54</em>(1), 63-80.</a>
                                <span class="citation-note">Shows morphological awareness significantly predicts comprehension development.</span>
                            </li>
                            <li>
                                <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4516776/" target="_blank" rel="noopener">Tighe, E.L., & Schatschneider, C. (2016). Examining the relationships of component reading skills to reading comprehension in struggling adult readers. <em>Journal of Learning Disabilities, 49</em>(4), 395-409.</a>
                                <span class="citation-note">Shows morphological skills remain predictive of reading ability into adulthood.</span>
                            </li>
                            <li>
                                <a href="https://www.frontiersin.org/articles/10.3389/fpsyg.2014.00452/full" target="_blank" rel="noopener">Rastle, K., & Davis, M.H. (2008). Morphological decomposition based on the analysis of orthography. <em>Language and Cognitive Processes, 23</em>(7-8), 942-971.</a>
                                <span class="citation-note">Evidence that morphemes are processed as discrete visual units during reading.</span>
                            </li>
                        </ul>
                        <div class="research-insight">
                            <strong>ðŸ’¡ Academic Reading:</strong> Particularly valuable for STEM, medical, and legal texts where Latin/Greek morphemes carry precise meaning (e.g., "anti-", "bio-", "-ology").
                        </div>
                    </div>
                </details>

                <!-- Minimal -->
                <details id="research-minimal" class="research-section">
                    <summary class="research-header">
                        <span class="research-icon">â—‹</span>
                        <span>Minimal</span>
                    </summary>
                    <div class="research-content">
                        <p>For highly skilled readers, highlighting can become a distraction. Research on expertise suggests that once recognition is automatized, visual scaffolding may actually slow processing by adding unnecessary cognitive load.</p>
                        
                        <h4>Key Research</h4>
                        <ul class="citation-list">
                            <li>
                                <a href="https://www.sciencedirect.com/science/article/pii/S1364661315002521" target="_blank" rel="noopener">Rayner, K., Pollatsek, A., Ashby, J., & Clifton Jr., C. (2012). <em>Psychology of Reading</em> (2nd ed.). Psychology Press.</a>
                                <span class="citation-note">Comprehensive review showing skilled readers process words in 150-300ms with minimal fixation.</span>
                            </li>
                            <li>
                                <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3579148/" target="_blank" rel="noopener">Kalyuga, S. (2007). Expertise reversal effect and its implications for learner-tailored instruction. <em>Educational Psychology Review, 19</em>(4), 509-539.</a>
                                <span class="citation-note">Shows that scaffolding aids novices but can hinder expert performance.</span>
                            </li>
                            <li>
                                <a href="https://link.springer.com/article/10.3758/s13423-015-0879-y" target="_blank" rel="noopener">Schotter, E.R., Tran, R., & Rayner, K. (2014). Don't believe what you read (only once): Comprehension is supported by regressions during reading. <em>Psychological Science, 25</em>(6), 1218-1226.</a>
                                <span class="citation-note">Evidence on skilled reading strategies and reduced need for visual guides.</span>
                            </li>
                        </ul>
                    </div>
                </details>

                <!-- Summary Table -->
                <div class="research-summary">
                    <h3>Quick Reference Guide</h3>
                    <table class="research-table">
                        <thead>
                            <tr>
                                <th>Mode</th>
                                <th>Best For</th>
                                <th>Speed Impact</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><span class="mode-badge">â—‰ Classic</span></td>
                                <td>General reading, fiction</td>
                                <td>âš¡âš¡âš¡ Fast</td>
                            </tr>
                            <tr>
                                <td><span class="mode-badge">âŸ¨âŸ© Start-End</span></td>
                                <td>Technical docs, accessibility</td>
                                <td>âš¡âš¡âš¡ Fast</td>
                            </tr>
                            <tr>
                                <td><span class="mode-badge">â†” Adaptive</span></td>
                                <td>Mixed content</td>
                                <td>âš¡âš¡âš¡ Fast</td>
                            </tr>
                            <tr>
                                <td><span class="mode-badge">âˆ¿ Syllable</span></td>
                                <td>Language learning, new vocabulary</td>
                                <td>âš¡âš¡ Moderate</td>
                            </tr>
                            <tr>
                                <td><span class="mode-badge">â§ˆ Morpheme</span></td>
                                <td>Academic, STEM, legal/medical</td>
                                <td>âš¡âš¡ Moderate</td>
                            </tr>
                            <tr>
                                <td><span class="mode-badge">â—‹ Minimal</span></td>
                                <td>Expert speed readers</td>
                                <td>âš¡âš¡âš¡âš¡ Fastest</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <p class="research-footer">
                    <em>All citations link to DOI (Digital Object Identifier) for permanent, verifiable access to original research papers.</em>
                </p>
            </div>
        </div>
    </div>

    <!-- Welcome Screen -->
    <div id="welcomeBackdrop" class="modal-backdrop hidden">
        <div class="modal modal-welcome">
            <div class="modal-header">
                <h2>Welcome to FastReader</h2>
            </div>
            
            <div class="modal-body">
                <p class="welcome-intro">Choose a highlight mode based on what you'll be reading:</p>
                
                <div class="welcome-modes-grid">
                    <!-- Classic ORP -->
                    <div class="welcome-mode-card" data-mode="classic">
                        <div class="mode-icon">â—‰</div>
                        <div class="mode-info">
                            <h3>Classic (ORP)</h3>
                            <p class="mode-desc">Center-focused highlighting at the Optimal Recognition Point</p>
                            <p class="mode-best"><strong>Best for:</strong> General reading, fiction, news articles</p>
                            <div class="mode-pros-cons">
                                <span class="pro">âœ“ Minimizes eye movement</span>
                                <span class="pro">âœ“ Industry standard</span>
                                <span class="con">âœ— Less effective for long words</span>
                            </div>
                        </div>
                    </div>

                    <!-- Start-End Anchoring -->
                    <div class="welcome-mode-card" data-mode="startEnd">
                        <div class="mode-icon">âŸ¨âŸ©</div>
                        <div class="mode-info">
                            <h3>Start-End Anchoring</h3>
                            <p class="mode-desc">Highlights first <span style="color:#4dabf7">(blue)</span> and last <span style="color:#51cf66">(green)</span> letters</p>
                            <p class="mode-best"><strong>Best for:</strong> Technical docs, compound words, accessibility</p>
                            <div class="mode-pros-cons">
                                <span class="pro">âœ“ Matches natural reading patterns</span>
                                <span class="pro">âœ“ Dyslexia-friendly</span>
                                <span class="con">âœ— Less effective for short words</span>
                            </div>
                        </div>
                    </div>

                    <!-- Adaptive Focus -->
                    <div class="welcome-mode-card" data-mode="adaptive">
                        <div class="mode-icon">â†”</div>
                        <div class="mode-info">
                            <h3>Adaptive Focus</h3>
                            <p class="mode-desc">Dynamically shifts highlight based on word structure</p>
                            <p class="mode-best"><strong>Best for:</strong> Mixed content, varied vocabulary</p>
                            <div class="mode-pros-cons">
                                <span class="pro">âœ“ Best of both worlds</span>
                                <span class="pro">âœ“ Reduces monotony</span>
                                <span class="con">âœ— Requires adjustment period</span>
                            </div>
                        </div>
                    </div>

                    <!-- Syllable Rhythm -->
                    <div class="welcome-mode-card" data-mode="syllable">
                        <div class="mode-icon">âˆ¿</div>
                        <div class="mode-info">
                            <h3>Syllable Rhythm</h3>
                            <p class="mode-desc">Alternates colors by syllables for phonetic chunking</p>
                            <p class="mode-best"><strong>Best for:</strong> Language learning, scientific terms</p>
                            <div class="mode-pros-cons">
                                <span class="pro">âœ“ Helps pronunciation</span>
                                <span class="pro">âœ“ Great for new vocabulary</span>
                                <span class="con">âœ— Slower for expert readers</span>
                            </div>
                        </div>
                    </div>

                    <!-- Morpheme Structure -->
                    <div class="welcome-mode-card" data-mode="morpheme">
                        <div class="mode-icon">â§ˆ</div>
                        <div class="mode-info">
                            <h3>Morpheme Structure</h3>
                            <p class="mode-desc">Colors <span style="color:#4dabf7">prefix</span>, root, and <span style="color:#51cf66">suffix</span> differently</p>
                            <p class="mode-best"><strong>Best for:</strong> Academic papers, medical/legal text, STEM</p>
                            <div class="mode-pros-cons">
                                <span class="pro">âœ“ Reveals word meaning</span>
                                <span class="pro">âœ“ Aids comprehension</span>
                                <span class="con">âœ— Overkill for simple text</span>
                            </div>
                        </div>
                    </div>

                    <!-- Minimal -->
                    <div class="welcome-mode-card" data-mode="minimal">
                        <div class="mode-icon">â—‹</div>
                        <div class="mode-info">
                            <h3>Minimal</h3>
                            <p class="mode-desc">Clean single-color display without highlighting</p>
                            <p class="mode-best"><strong>Best for:</strong> Experienced speed readers</p>
                            <div class="mode-pros-cons">
                                <span class="pro">âœ“ No distractions</span>
                                <span class="pro">âœ“ Maximum speed potential</span>
                                <span class="con">âœ— Not for beginners</span>
                            </div>
                        </div>
                    </div>
                </div>

                <p class="welcome-footer">
                    <em>You can change this anytime in the settings panel. Click a mode to begin!</em>
                </p>
            </div>
            
            <div class="modal-footer">
                <button id="skipWelcomeBtn" class="btn btn-secondary">Skip (use Classic)</button>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="lib/pdf.min.js"></script>
    <script src="db.js"></script>
    <script src="pdf-loader.js"></script>
    <script src="app.js"></script>
    
    <!-- Service Worker Registration -->
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('sw.js')
                    .then(reg => console.log('SW registered:', reg.scope))
                    .catch(err => console.warn('SW registration failed:', err));
            });
        }
    </script>
</body>
</html>
